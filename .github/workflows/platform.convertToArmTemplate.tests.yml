name: '.Platform: run pester test for convert to ARM template script'

on:
  push:
    branches:
      - users/rahalan/TestConversionScript_alsehr
    paths:
      - 'utilities/tools/ConvertTo-ARMTemplate.ps1'
      - 'utilities/tools/tests/ConvertTo-ARMTemplate**'

jobs:
  job_test_Default:
    runs-on: windows-latest
    name: 'Run test for default parameter'
    steps:
      - name: 'Checkout'
        uses: actions/checkout@v2
        with:
          fetch-depth: 0
          token: '${{ secrets.PLATFORM_REPO_UPDATE_PAT }}' # Sets general GIT credentials up
      - name: 'Run Pester tests'
        shell: pwsh
        run: |
          Invoke-Pester -Path "$env:GITHUB_WORKSPACE/utilities/tools/tests/ConvertTo-ARMTemplate.Tests.ps1" -Verbose
  # job_test_Default:
  #   runs-on: windows-latest
  #   name: 'Run test for default parameter'
  #   steps:
  #     - name: 'Checkout'
  #       uses: actions/checkout@v2
  #       with:
  #         fetch-depth: 0
  #         token: '${{ secrets.PLATFORM_REPO_UPDATE_PAT }}' # Sets general GIT credentials up
  #     - name: 'Run Pester tests'
  #       shell: pwsh
  #       run: |
  #         Invoke-Pester -Path ./utilities/tools/tests/ConvertTo-ARMTemplate-Default.Tests.ps1 -Verbose
  # job_test_ConvertChildren:
  #   runs-on: windows-latest
  #   name: 'Run test for -ConvertChildren parameter'
  #   steps:
  #     - name: 'Checkout'
  #       uses: actions/checkout@v2
  #       with:
  #         fetch-depth: 0
  #         token: '${{ secrets.PLATFORM_REPO_UPDATE_PAT }}' # Sets general GIT credentials up
  #     - name: 'Run Pester tests'
  #       shell: pwsh
  #       run: |
  #         Invoke-Pester -Path ./utilities/tools/tests/ConvertTo-ARMTemplate-ConvertChildren.Tests.ps1 -Verbose
  # job_test_SkipMetadataCleanup:
  #   runs-on: windows-latest
  #   name: 'Run test for -SkipMetadataCleanup parameter'
  #   steps:
  #     - name: 'Checkout'
  #       uses: actions/checkout@v2
  #       with:
  #         fetch-depth: 0
  #         token: '${{ secrets.PLATFORM_REPO_UPDATE_PAT }}' # Sets general GIT credentials up
  #     - name: 'Run Pester tests'
  #       shell: pwsh
  #       run: |
  #         Invoke-Pester -Path ./utilities/tools/tests/ConvertTo-ARMTemplate-SkipMetadataCleanup.Tests.ps1 -Verbose
  # job_test_SkipBicepCleanUp:
  #   runs-on: windows-latest
  #   name: 'Run test for -SkipBicepCleanUp parameter'
  #   steps:
  #     - name: 'Checkout'
  #       uses: actions/checkout@v2
  #       with:
  #         fetch-depth: 0
  #         token: '${{ secrets.PLATFORM_REPO_UPDATE_PAT }}' # Sets general GIT credentials up
  #     - name: 'Run Pester tests'
  #       shell: pwsh
  #       run: |
  #         Invoke-Pester -Path ./utilities/tools/tests/ConvertTo-ARMTemplate-SkipBicepCleanUp.Tests.ps1 -Verbose
  # job_test_SkipWorkflowUpdate:
  #   runs-on: windows-latest
  #   name: 'Run test for -SkipWorkflowUpdate parameter'
  #   steps:
  #     - name: 'Checkout'
  #       uses: actions/checkout@v2
  #       with:
  #         fetch-depth: 0
  #         token: '${{ secrets.PLATFORM_REPO_UPDATE_PAT }}' # Sets general GIT credentials up
  #     - name: 'Run Pester tests'
  #       shell: pwsh
  #       run: |
  #         Invoke-Pester -Path ./utilities/tools/tests/ConvertTo-ARMTemplate-SkipWorkflowUpdate.Tests.ps1 -Verbose
